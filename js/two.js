(function(){var B=this,m=B._,h={},f=Array.prototype,q=Object.prototype,p=f.push,d=f.slice,n=f.concat,l=q.toString,v=q.hasOwnProperty,G=f.forEach,w=f.map,s=f.reduce,c=f.reduceRight,C=f.filter,x=f.every,A=f.some,y=f.indexOf,z=f.lastIndexOf,q=Array.isArray,E=Object.keys,F=Function.prototype.bind,a=function(e){if(e instanceof a)return e;if(!(this instanceof a))return new a(e);this._wrapped=e};"undefined"!==typeof exports?("undefined"!==typeof module&&module.exports&&(exports=module.exports=a),exports._=
a):B._=a;a.VERSION="1.5.1";var b=a.each=a.forEach=function(e,k,t){if(null!=e)if(G&&e.forEach===G)e.forEach(k,t);else if(e.length===+e.length)for(var b=0,c=e.length;b<c&&k.call(t,e[b],b,e)!==h;b++);else for(b in e)if(a.has(e,b)&&k.call(t,e[b],b,e)===h)break};a.map=a.collect=function(e,a,t){var c=[];if(null==e)return c;if(w&&e.map===w)return e.map(a,t);b(e,function(e,b,g){c.push(a.call(t,e,b,g))});return c};a.reduce=a.foldl=a.inject=function(e,k,t,c){var g=2<arguments.length;null==e&&(e=[]);if(s&&e.reduce===
s)return c&&(k=a.bind(k,c)),g?e.reduce(k,t):e.reduce(k);b(e,function(e,a,b){g?t=k.call(c,t,e,a,b):(t=e,g=!0)});if(!g)throw new TypeError("Reduce of empty array with no initial value");return t};a.reduceRight=a.foldr=function(e,k,t,g){var r=2<arguments.length;null==e&&(e=[]);if(c&&e.reduceRight===c)return g&&(k=a.bind(k,g)),r?e.reduceRight(k,t):e.reduceRight(k);var d=e.length;if(d!==+d)var l=a.keys(e),d=l.length;b(e,function(a,b,c){b=l?l[--d]:--d;r?t=k.call(g,t,e[b],b,c):(t=e[b],r=!0)});if(!r)throw new TypeError("Reduce of empty array with no initial value");
return t};a.find=a.detect=function(e,a,t){var b;r(e,function(e,c,g){if(a.call(t,e,c,g))return b=e,!0});return b};a.filter=a.select=function(e,a,t){var c=[];if(null==e)return c;if(C&&e.filter===C)return e.filter(a,t);b(e,function(e,b,g){a.call(t,e,b,g)&&c.push(e)});return c};a.reject=function(e,k,b){return a.filter(e,function(e,a,c){return!k.call(b,e,a,c)},b)};a.every=a.all=function(e,k,t){k||(k=a.identity);var c=!0;if(null==e)return c;if(x&&e.every===x)return e.every(k,t);b(e,function(e,a,b){if(!(c=
c&&k.call(t,e,a,b)))return h});return!!c};var r=a.some=a.any=function(e,k,t){k||(k=a.identity);var c=!1;if(null==e)return c;if(A&&e.some===A)return e.some(k,t);b(e,function(e,a,b){if(c||(c=k.call(t,e,a,b)))return h});return!!c};a.contains=a.include=function(e,a){return null==e?!1:y&&e.indexOf===y?-1!=e.indexOf(a):r(e,function(e){return e===a})};a.invoke=function(e,k){var b=d.call(arguments,2),c=a.isFunction(k);return a.map(e,function(e){return(c?k:e[k]).apply(e,b)})};a.pluck=function(e,k){return a.map(e,
function(e){return e[k]})};a.where=function(e,k,b){return a.isEmpty(k)?b?void 0:[]:a[b?"find":"filter"](e,function(e){for(var a in k)if(k[a]!==e[a])return!1;return!0})};a.findWhere=function(e,k){return a.where(e,k,!0)};a.max=function(e,k,t){if(!k&&a.isArray(e)&&e[0]===+e[0]&&65535>e.length)return Math.max.apply(Math,e);if(!k&&a.isEmpty(e))return-Infinity;var c={computed:-Infinity,value:-Infinity};b(e,function(e,a,b){a=k?k.call(t,e,a,b):e;a>c.computed&&(c={value:e,computed:a})});return c.value};a.min=
function(e,k,t){if(!k&&a.isArray(e)&&e[0]===+e[0]&&65535>e.length)return Math.min.apply(Math,e);if(!k&&a.isEmpty(e))return Infinity;var c={computed:Infinity,value:Infinity};b(e,function(e,a,b){a=k?k.call(t,e,a,b):e;a<c.computed&&(c={value:e,computed:a})});return c.value};a.shuffle=function(e){var k,t=0,c=[];b(e,function(e){k=a.random(t++);c[t-1]=c[k];c[k]=e});return c};var g=function(e){return a.isFunction(e)?e:function(a){return a[e]}};a.sortBy=function(e,k,b){var c=g(k);return a.pluck(a.map(e,function(e,
a,k){return{value:e,index:a,criteria:c.call(b,e,a,k)}}).sort(function(e,a){var k=e.criteria,b=a.criteria;if(k!==b){if(k>b||void 0===k)return 1;if(k<b||void 0===b)return-1}return e.index<a.index?-1:1}),"value")};var H=function(e,k,t,c){var r={},d=g(null==k?a.identity:k);b(e,function(a,k){var b=d.call(t,a,k,e);c(r,b,a)});return r};a.groupBy=function(e,k,b){return H(e,k,b,function(e,k,b){(a.has(e,k)?e[k]:e[k]=[]).push(b)})};a.countBy=function(e,k,b){return H(e,k,b,function(e,k){a.has(e,k)||(e[k]=0);
e[k]++})};a.sortedIndex=function(e,k,b,c){b=null==b?a.identity:g(b);k=b.call(c,k);for(var r=0,d=e.length;r<d;){var l=r+d>>>1;b.call(c,e[l])<k?r=l+1:d=l}return r};a.toArray=function(e){return e?a.isArray(e)?d.call(e):e.length===+e.length?a.map(e,a.identity):a.values(e):[]};a.size=function(e){return null==e?0:e.length===+e.length?e.length:a.keys(e).length};a.first=a.head=a.take=function(e,a,b){return null==e?void 0:null==a||b?e[0]:d.call(e,0,a)};a.initial=function(e,a,b){return d.call(e,0,e.length-
(null==a||b?1:a))};a.last=function(e,a,b){return null==e?void 0:null==a||b?e[e.length-1]:d.call(e,Math.max(e.length-a,0))};a.rest=a.tail=a.drop=function(e,a,b){return d.call(e,null==a||b?1:a)};a.compact=function(e){return a.filter(e,a.identity)};var u=function(e,k,c){if(k&&a.every(e,a.isArray))return n.apply(c,e);b(e,function(e){a.isArray(e)||a.isArguments(e)?k?p.apply(c,e):u(e,k,c):c.push(e)});return c};a.flatten=function(e,a){return u(e,a,[])};a.without=function(e){return a.difference(e,d.call(arguments,
1))};a.uniq=a.unique=function(e,k,c,g){a.isFunction(k)&&(g=c,c=k,k=!1);c=c?a.map(e,c,g):e;var r=[],d=[];b(c,function(b,c){(k?c&&d[d.length-1]===b:a.contains(d,b))||(d.push(b),r.push(e[c]))});return r};a.union=function(){return a.uniq(a.flatten(arguments,!0))};a.intersection=function(e){var k=d.call(arguments,1);return a.filter(a.uniq(e),function(e){return a.every(k,function(k){return 0<=a.indexOf(k,e)})})};a.difference=function(e){var k=n.apply(f,d.call(arguments,1));return a.filter(e,function(e){return!a.contains(k,
e)})};a.zip=function(){for(var e=a.max(a.pluck(arguments,"length").concat(0)),k=Array(e),b=0;b<e;b++)k[b]=a.pluck(arguments,""+b);return k};a.object=function(e,a){if(null==e)return{};for(var b={},c=0,g=e.length;c<g;c++)a?b[e[c]]=a[c]:b[e[c][0]]=e[c][1];return b};a.indexOf=function(e,k,b){if(null==e)return-1;var c=0,g=e.length;if(b)if("number"==typeof b)c=0>b?Math.max(0,g+b):b;else return c=a.sortedIndex(e,k),e[c]===k?c:-1;if(y&&e.indexOf===y)return e.indexOf(k,b);for(;c<g;c++)if(e[c]===k)return c;
return-1};a.lastIndexOf=function(e,a,b){if(null==e)return-1;var c=null!=b;if(z&&e.lastIndexOf===z)return c?e.lastIndexOf(a,b):e.lastIndexOf(a);for(b=c?b:e.length;b--;)if(e[b]===a)return b;return-1};a.range=function(e,a,b){1>=arguments.length&&(a=e||0,e=0);b=arguments[2]||1;for(var c=Math.max(Math.ceil((a-e)/b),0),g=0,r=Array(c);g<c;)r[g++]=e,e+=b;return r};var D=function(){};a.bind=function(e,b){var c,g;if(F&&e.bind===F)return F.apply(e,d.call(arguments,1));if(!a.isFunction(e))throw new TypeError;
c=d.call(arguments,2);return g=function(){if(!(this instanceof g))return e.apply(b,c.concat(d.call(arguments)));D.prototype=e.prototype;var a=new D;D.prototype=null;var r=e.apply(a,c.concat(d.call(arguments)));return Object(r)===r?r:a}};a.partial=function(a){var b=d.call(arguments,1);return function(){return a.apply(this,b.concat(d.call(arguments)))}};a.bindAll=function(e){var k=d.call(arguments,1);if(0===k.length)throw Error("bindAll must be passed function names");b(k,function(b){e[b]=a.bind(e[b],
e)});return e};a.memoize=function(e,b){var c={};b||(b=a.identity);return function(){var g=b.apply(this,arguments);return a.has(c,g)?c[g]:c[g]=e.apply(this,arguments)}};a.delay=function(a,b){var c=d.call(arguments,2);return setTimeout(function(){return a.apply(null,c)},b)};a.defer=function(e){return a.delay.apply(a,[e,1].concat(d.call(arguments,1)))};a.throttle=function(a,b,c){var g,r,d,l=null,f=0;c||(c={});var u=function(){f=!1===c.leading?0:new Date;l=null;d=a.apply(g,r)};return function(){var H=
new Date;f||!1!==c.leading||(f=H);var n=b-(H-f);g=this;r=arguments;0>=n?(clearTimeout(l),l=null,f=H,d=a.apply(g,r)):l||!1===c.trailing||(l=setTimeout(u,n));return d}};a.debounce=function(a,b,c){var g,r=null;return function(){var d=this,l=arguments,f=c&&!r;clearTimeout(r);r=setTimeout(function(){r=null;c||(g=a.apply(d,l))},b);f&&(g=a.apply(d,l));return g}};a.once=function(a){var b=!1,c;return function(){if(b)return c;b=!0;c=a.apply(this,arguments);a=null;return c}};a.wrap=function(a,b){return function(){var c=
[a];p.apply(c,arguments);return b.apply(this,c)}};a.compose=function(){var a=arguments;return function(){for(var b=arguments,c=a.length-1;0<=c;c--)b=[a[c].apply(this,b)];return b[0]}};a.after=function(a,b){return function(){if(1>--a)return b.apply(this,arguments)}};a.keys=E||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var b=[],c;for(c in e)a.has(e,c)&&b.push(c);return b};a.values=function(e){var b=[],c;for(c in e)a.has(e,c)&&b.push(e[c]);return b};a.pairs=function(e){var b=
[],c;for(c in e)a.has(e,c)&&b.push([c,e[c]]);return b};a.invert=function(e){var b={},c;for(c in e)a.has(e,c)&&(b[e[c]]=c);return b};a.functions=a.methods=function(e){var b=[],c;for(c in e)a.isFunction(e[c])&&b.push(c);return b.sort()};a.extend=function(a){b(d.call(arguments,1),function(b){if(b)for(var c in b)a[c]=b[c]});return a};a.pick=function(a){var c={},g=n.apply(f,d.call(arguments,1));b(g,function(b){b in a&&(c[b]=a[b])});return c};a.omit=function(e){var b={},c=n.apply(f,d.call(arguments,1)),
g;for(g in e)a.contains(c,g)||(b[g]=e[g]);return b};a.defaults=function(a){b(d.call(arguments,1),function(b){if(b)for(var c in b)void 0===a[c]&&(a[c]=b[c])});return a};a.clone=function(e){return a.isObject(e)?a.isArray(e)?e.slice():a.extend({},e):e};a.tap=function(a,b){b(a);return a};var I=function(e,b,c,g){if(e===b)return 0!==e||1/e==1/b;if(null==e||null==b)return e===b;e instanceof a&&(e=e._wrapped);b instanceof a&&(b=b._wrapped);var r=l.call(e);if(r!=l.call(b))return!1;switch(r){case "[object String]":return e==
String(b);case "[object Number]":return e!=+e?b!=+b:0==e?1/e==1/b:e==+b;case "[object Date]":case "[object Boolean]":return+e==+b;case "[object RegExp]":return e.source==b.source&&e.global==b.global&&e.multiline==b.multiline&&e.ignoreCase==b.ignoreCase}if("object"!=typeof e||"object"!=typeof b)return!1;for(var d=c.length;d--;)if(c[d]==e)return g[d]==b;var d=e.constructor,f=b.constructor;if(d!==f&&!(a.isFunction(d)&&d instanceof d&&a.isFunction(f)&&f instanceof f))return!1;c.push(e);g.push(b);d=0;
f=!0;if("[object Array]"==r){if(d=e.length,f=d==b.length)for(;d--&&(f=I(e[d],b[d],c,g)););}else{for(var u in e)if(a.has(e,u)&&(d++,!(f=a.has(b,u)&&I(e[u],b[u],c,g))))break;if(f){for(u in b)if(a.has(b,u)&&!d--)break;f=!d}}c.pop();g.pop();return f};a.isEqual=function(a,b){return I(a,b,[],[])};a.isEmpty=function(e){if(null==e)return!0;if(a.isArray(e)||a.isString(e))return 0===e.length;for(var b in e)if(a.has(e,b))return!1;return!0};a.isElement=function(a){return!(!a||1!==a.nodeType)};a.isArray=q||function(a){return"[object Array]"==
l.call(a)};a.isObject=function(a){return a===Object(a)};b("Arguments Function String Number Date RegExp".split(" "),function(e){a["is"+e]=function(a){return l.call(a)=="[object "+e+"]"}});a.isArguments(arguments)||(a.isArguments=function(e){return!(!e||!a.has(e,"callee"))});"function"!==typeof/./&&(a.isFunction=function(a){return"function"===typeof a});a.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))};a.isNaN=function(e){return a.isNumber(e)&&e!=+e};a.isBoolean=function(a){return!0===
a||!1===a||"[object Boolean]"==l.call(a)};a.isNull=function(a){return null===a};a.isUndefined=function(a){return void 0===a};a.has=function(a,b){return v.call(a,b)};a.noConflict=function(){B._=m;return this};a.identity=function(a){return a};a.times=function(a,b,c){for(var g=Array(Math.max(0,a)),r=0;r<a;r++)g[r]=b.call(c,r);return g};a.random=function(a,b){null==b&&(b=a,a=0);return a+Math.floor(Math.random()*(b-a+1))};var J={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};
J.unescape=a.invert(J.escape);var M={escape:RegExp("["+a.keys(J.escape).join("")+"]","g"),unescape:RegExp("("+a.keys(J.unescape).join("|")+")","g")};a.each(["escape","unescape"],function(b){a[b]=function(a){return null==a?"":(""+a).replace(M[b],function(a){return J[b][a]})}});a.result=function(b,c){if(null!=b){var g=b[c];return a.isFunction(g)?g.call(b):g}};a.mixin=function(e){b(a.functions(e),function(b){var c=a[b]=e[b];a.prototype[b]=function(){var b=[this._wrapped];p.apply(b,arguments);b=c.apply(a,
b);return this._chain?a(b).chain():b}})};var P=0;a.uniqueId=function(a){var b=++P+"";return a?a+b:b};a.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var N=/(.)^/,O={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},L=/\\|'|\r|\n|\t|\u2028|\u2029/g;a.template=function(b,c,g){var r;g=a.defaults({},g,a.templateSettings);var d=RegExp([(g.escape||N).source,(g.interpolate||N).source,(g.evaluate||N).source].join("|")+
"|$","g"),f=0,l="__p+='";b.replace(d,function(a,c,g,r,k){l+=b.slice(f,k).replace(L,function(a){return"\\"+O[a]});c&&(l+="'+\n((__t=("+c+"))==null?'':_.escape(__t))+\n'");g&&(l+="'+\n((__t=("+g+"))==null?'':__t)+\n'");r&&(l+="';\n"+r+"\n__p+='");f=k+a.length;return a});l+="';\n";g.variable||(l="with(obj||{}){\n"+l+"}\n");l="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+l+"return __p;\n";try{r=new Function(g.variable||"obj","_",l)}catch(u){throw u.source=
l,u;}if(c)return r(c,a);c=function(b){return r.call(this,b,a)};c.source="function("+(g.variable||"obj")+"){\n"+l+"}";return c};a.chain=function(b){return a(b).chain()};a.mixin(a);b("pop push reverse shift sort splice unshift".split(" "),function(b){var c=f[b];a.prototype[b]=function(){var g=this._wrapped;c.apply(g,arguments);"shift"!=b&&"splice"!=b||0!==g.length||delete g[0];return this._chain?a(g).chain():g}});b(["concat","join","slice"],function(b){var c=f[b];a.prototype[b]=function(){var b=c.apply(this._wrapped,
arguments);return this._chain?a(b).chain():b}});a.extend(a.prototype,{chain:function(){this._chain=!0;return this},value:function(){return this._wrapped}})}).call(this);var Backbone=Backbone||{};
(function(){var B=[].slice,m=function(f,q,p){var d;f=-1;var n=q.length;switch(p.length){case 0:for(;++f<n;)(d=q[f]).callback.call(d.ctx);break;case 1:for(;++f<n;)(d=q[f]).callback.call(d.ctx,p[0]);break;case 2:for(;++f<n;)(d=q[f]).callback.call(d.ctx,p[0],p[1]);break;case 3:for(;++f<n;)(d=q[f]).callback.call(d.ctx,p[0],p[1],p[2]);break;default:for(;++f<n;)(d=q[f]).callback.apply(d.ctx,p)}},h=Backbone.Events={on:function(f,q,p){this._events||(this._events={});(this._events[f]||(this._events[f]=[])).push({callback:q,
context:p,ctx:p||this});return this},once:function(f,q,p){var d=this,n=_.once(function(){d.off(f,n);q.apply(this,arguments)});n._callback=q;this.on(f,n,p);return this},off:function(f,q,p){var d,n,l,h,m,w,s,c;if(!this._events)return this;if(!f&&!q&&!p)return this._events={},this;h=f?[f]:_.keys(this._events);m=0;for(w=h.length;m<w;m++)if(f=h[m],d=this._events[f]){l=[];if(q||p)for(s=0,c=d.length;s<c;s++)n=d[s],(q&&q!==(n.callback._callback||n.callback)||p&&p!==n.context)&&l.push(n);this._events[f]=l}return this},
trigger:function(f){if(!this._events)return this;var q=B.call(arguments,1),h=this._events[f],d=this._events.all;h&&m(this,h,q);d&&m(this,d,arguments);return this},listenTo:function(f,q,h){var d=this._listeners||(this._listeners={}),n=f._listenerId||(f._listenerId=_.uniqueId("l"));d[n]=f;f.on(q,h||this,this);return this},stopListening:function(f,q,h){var d=this._listeners;if(d){if(f)f.off(q,h,this),q||h||delete d[f._listenerId];else{for(var n in d)d[n].off(null,null,this);this._listeners={}}return this}}};
h.bind=h.on;h.unbind=h.off;"undefined"!==typeof exports&&("undefined"!==typeof module&&module.exports&&(exports=module.exports=h),exports.Backbone=exports.Backbone||Backbone)})();(function(){function B(f,d){var n=(new Date).getTime(),l=Math.max(0,16-(n-h)),q=m.setTimeout(function(){f(n+l)},l);h=n+l;return q}var m=this,h=0,f=["ms","moz","webkit","o"];if("undefined"!==typeof exports)"undefined"!==typeof module&&module.exports&&(exports=module.exports=B),exports.requestAnimationFrame=B;else{for(var q=0;q<f.length&&!m.requestAnimationFrame;++q)m.requestAnimationFrame=m[f[q]+"RequestAnimationFrame"],m.cancelAnimationFrame=m[f[q]+"CancelAnimationFrame"]||m[f[q]+"CancelRequestAnimationFrame"];
m.requestAnimationFrame||(m.requestAnimationFrame=B);m.cancelAnimationFrame||(m.cancelAnimationFrame=function(f){clearTimeout(f)})}})();(function(){function B(){var a=document.body.getBoundingClientRect(),b=this.width=a.width,a=this.height=a.height;this.renderer.setSize(b,a,this.ratio);this.trigger(c.Events.resize,b,a)}var m=this,h=m.Two||{},f=Math.sin,q=Math.cos,p=Math.atan2,d=Math.sqrt,n=Math.PI,l=2*n,v=n/2,G=Math.pow,w=0,s={hasEventListeners:_.isFunction(m.addEventListener),bind:function(a,b,c,g){this.hasEventListeners?a.addEventListener(b,c,!!g):a.attachEvent("on"+b,c);return this},unbind:function(a,b,c,g){this.hasEventListeners?
a.removeEventListeners(b,c,!!g):a.detachEvent("on"+b,c);return this}},c=m.Two=function(a){a=_.defaults(a||{},{fullscreen:!1,width:640,height:480,type:c.Types.svg,autostart:!1});_.each(a,function(a,c){"fullscreen"!==c&&("width"!==c&&"height"!==c&&"autostart"!==c)&&(this[c]=a)},this);_.isElement(a.domElement)&&(this.type=c.Types[a.domElement.tagName.toLowerCase()]);this.renderer=new c[this.type](this);c.Utils.setPlaying.call(this,a.autostart);this.frameCount=0;a.fullscreen?(a=_.bind(B,this),_.extend(document.body.style,
{overflow:"hidden",margin:0,padding:0,top:0,left:0,right:0,bottom:0,position:"fixed"}),_.extend(this.renderer.domElement.style,{display:"block",top:0,left:0,right:0,bottom:0,position:"fixed"}),s.bind(m,"resize",a),a()):_.isElement(a.domElement)||(this.renderer.setSize(a.width,a.height,this.ratio),this.width=a.width,this.height=a.height);this.scene=this.renderer.scene;c.Instances.push(this)};_.extend(c,{Array:m.Float32Array||Array,Types:{webgl:"WebGLRenderer",svg:"SVGRenderer",canvas:"CanvasRenderer"},
Version:"v0.4.0",Identifier:"two-",Properties:{hierarchy:"hierarchy",demotion:"demotion"},Events:{play:"play",pause:"pause",update:"update",render:"render",resize:"resize",change:"change",remove:"remove",insert:"insert"},Commands:{move:"M",line:"L",curve:"C",close:"Z"},Resolution:8,Instances:[],noConflict:function(){m.Two=h;return this},uniqueId:function(){var a=w;w++;return a},Utils:{Curve:{CollinearityEpsilon:G(10,-30),RecursionLimit:16,CuspLimit:0,Tolerance:{distance:0.25,angle:0,epsilon:0.01}},
devicePixelRatio:m.devicePixelRatio||1,getBackingStoreRatio:function(a){return a.webkitBackingStorePixelRatio||a.mozBackingStorePixelRatio||a.msBackingStorePixelRatio||a.oBackingStorePixelRatio||a.backingStorePixelRatio||1},getRatio:function(a){return c.Utils.devicePixelRatio/E(a)},setPlaying:function(a){this.playing=!!a;return this},getComputedMatrix:function(a,b){b=b&&b.identity()||new c.Matrix;for(var r=a;r&&r._matrix;){var g=r._matrix.elements;b.multiply(g[0],g[1],g[2],g[3],g[4],g[5],g[6],g[7],
g[8],g[9]);r=r.parent}return b},applySvgAttributes:function(a,b){_.each(a.attributes,function(a,c){switch(a.nodeName){case "visibility":b.visible=!!a.nodeValue;break;case "stroke-linecap":b.cap=a.nodeValue;break;case "stroke-linejoin":b.join=a.nodeValue;break;case "stroke-miterlimit":b.miter=a.nodeValue;break;case "stroke-width":b.linewidth=parseFloat(a.nodeValue);break;case "stroke-opacity":case "fill-opacity":case "opacity":b.opacity=a.nodeValue;break;case "fill":b.fill=a.nodeValue;break;case "stroke":b.stroke=
a.nodeValue}});return b},read:{svg:function(){return c.Utils.read.g.apply(this,arguments)},g:function(a){var b=new c.Group;this.add(b);_.each(a.childNodes,function(a){var g=a.nodeName;g&&(g=g.replace(/svg\:/ig,"").toLowerCase(),g in c.Utils.read&&(a=c.Utils.read[g].call(this,a),b.add(a)))},this);return c.Utils.applySvgAttributes(a,b)},polygon:function(a,b){var d=[];a.getAttribute("points").replace(/([\d\.?]+),([\d\.?]+)/g,function(a,b,g){d.push(new c.Anchor(parseFloat(b),parseFloat(g)))});var g=(new c.Polygon(d,
!b)).noStroke();return c.Utils.applySvgAttributes(a,g)},polyline:function(a){return c.Utils.read.polygon(a,!0)},path:function(a){var b,d,g,l=!1,f=!1,n=a.getAttribute("d").match(/[a-df-z][^a-df-z]*/ig),q=n.length-1,n=_.flatten(_.map(n,function(a,n){var h,p,m=a[0],v=m.toLowerCase();g=a.slice(1).trim();g=g.replace(/(-?\d+(?:\.\d*)?)[eE]([+\-]?\d+)/g,function(a,b,e){return parseFloat(b)*Math.pow(10,e)});g=g.split(/[\s,]+|(?=\s?[+\-])/);l=m===v;var e,k,t,s;switch(v){case "z":n>=q?f=!0:(p=b.x,h=b.y,h=new c.Anchor(p,
h,void 0,void 0,void 0,void 0,c.Commands.close));break;case "m":case "l":p=parseFloat(g[0]);h=parseFloat(g[1]);h=new c.Anchor(p,h,void 0,void 0,void 0,void 0,"m"===v?c.Commands.move:c.Commands.line);l&&h.addSelf(b);h.controls.left.copy(h);h.controls.right.copy(h);b=h;break;case "h":case "v":p="h"===v?"x":"y";m="x"===p?"y":"x";h=new c.Anchor(void 0,void 0,void 0,void 0,void 0,void 0,c.Commands.line);h[p]=parseFloat(g[0]);h[m]=b[m];l&&(h[p]+=b[p]);h.controls.left.copy(h);h.controls.right.copy(h);b=
h;break;case "s":case "c":h=b.x;m=b.y;d||(d=(new c.Vector).copy(b));"c"===v?(e=parseFloat(g[0]),p=parseFloat(g[1]),v=parseFloat(g[2]),k=parseFloat(g[3]),t=parseFloat(g[4]),s=parseFloat(g[5])):(k=c.Utils.getReflection(b,d,l),e=k.x,p=k.y,v=parseFloat(g[0]),k=parseFloat(g[1]),t=parseFloat(g[2]),s=parseFloat(g[3]));l&&(e+=h,p+=m,v+=h,k+=m,t+=h,s+=m);_.isObject(b.controls)||c.Anchor.AppendCurveProperties(b);b.controls.right.set(e,p);b=h=new c.Anchor(t,s,v,k,void 0,void 0,c.Commands.curve);d=h.controls.left;
break;case "t":case "q":h=b.x;m=b.y;d||(d=(new c.Vector).copy(b));d.isZero()?(e=h,p=m):(e=d.x,m=d.y);"q"===v?(v=parseFloat(g[0]),k=parseFloat(g[1]),t=parseFloat(g[1]),s=parseFloat(g[2])):(k=c.Utils.getReflection(b,d,l),v=k.x,k=k.y,t=parseFloat(g[0]),s=parseFloat(g[1]));l&&(e+=h,p+=m,v+=h,k+=m,t+=h,s+=m);_.isObject(b.controls)||c.Anchor.AppendCurveProperties(b);b.controls.right.set(e,p);b=h=new c.Anchor(t,s,v,k,void 0,void 0,c.Commands.curve);d=h.controls.left;break;case "a":throw new c.Utils.Error("not yet able to interpret Elliptical Arcs.");
}return h}));if(!(1>=n.length))return n=_.compact(n),n=(new c.Polygon(n,f,void 0,!0)).noStroke(),c.Utils.applySvgAttributes(a,n)},circle:function(a){var b=parseFloat(a.getAttribute("cx")),d=parseFloat(a.getAttribute("cy")),g=parseFloat(a.getAttribute("r")),h=c.Resolution,u=_.map(_.range(h),function(a){var b=a/h*l;a=g*q(b);b=g*f(b);return new c.Anchor(a,b)},this),u=(new c.Polygon(u,!0,!0)).noStroke();u.translation.set(b,d);return c.Utils.applySvgAttributes(a,u)},ellipse:function(a){var b=parseFloat(a.getAttribute("cx")),
d=parseFloat(a.getAttribute("cy")),g=parseFloat(a.getAttribute("rx")),h=parseFloat(a.getAttribute("ry")),u=c.Resolution,n=_.map(_.range(u),function(a){var b=a/u*l;a=g*q(b);b=h*f(b);return new c.Anchor(a,b)},this),n=(new c.Polygon(n,!0,!0)).noStroke();n.translation.set(b,d);return c.Utils.applySvgAttributes(a,n)},rect:function(a){var b=parseFloat(a.getAttribute("x")),d=parseFloat(a.getAttribute("y")),g=parseFloat(a.getAttribute("width")),l=parseFloat(a.getAttribute("height")),g=g/2,l=l/2,f=[new c.Anchor(g,
l),new c.Anchor(-g,l),new c.Anchor(-g,-l),new c.Anchor(g,-l)],f=(new c.Polygon(f,!0)).noStroke();f.translation.set(b+g,d+l);return c.Utils.applySvgAttributes(a,f)},line:function(a){var b=parseFloat(a.getAttribute("x1")),d=parseFloat(a.getAttribute("y1")),g=parseFloat(a.getAttribute("x2")),l=parseFloat(a.getAttribute("y2")),g=(g-b)/2,l=(l-d)/2,f=[new c.Anchor(-g,-l),new c.Anchor(g,l)],f=(new c.Polygon(f)).noFill();f.translation.set(b+g,d+l);return c.Utils.applySvgAttributes(a,f)}},subdivide:function(a,
b,d,g,l,f,h,n,q){q=q||c.Utils.Curve.RecursionLimit;var p=q+1;return _.map(_.range(0,p),function(q){var m=q/p;q=F(m,a,d,l,h);m=F(m,b,g,f,n);return new c.Anchor(q,m)})},getPointOnCubicBezier:function(a,b,c,g,d){var l=1-a;return l*l*l*b+3*l*l*a*c+3*l*a*a*g+a*a*a*d},getCurveFromPoints:function(a,b){for(var d=a.length,g=d-1,l=0;l<d;l++){var f=a[l];_.isObject(f.controls)||c.Anchor.AppendCurveProperties(f);var h=b?z(l-1,d):Math.max(l-1,0),n=b?z(l+1,d):Math.min(l+1,g);y(a[h],f,a[n]);f._command=0===l?c.Commands.move:
c.Commands.curve;f.controls.left.x=_.isNumber(f.controls.left.x)?f.controls.left.x:f.x;f.controls.left.y=_.isNumber(f.controls.left.y)?f.controls.left.y:f.y;f.controls.right.x=_.isNumber(f.controls.right.x)?f.controls.right.x:f.x;f.controls.right.y=_.isNumber(f.controls.right.y)?f.controls.right.y:f.y}},getControlPoints:function(a,b,d){var g=A(a,b),l=A(d,b);a=C(a,b);d=C(d,b);var h=(g+l)/2;b.u=_.isObject(b.controls.left)?b.controls.left:new c.Vector(b.x,b.y);b.v=_.isObject(b.controls.right)?b.controls.right:
new c.Vector(b.x,b.y);if(1E-4>a||1E-4>d)return b.controls.left.copy(b),b.controls.right.copy(b),b;a*=0.33;d*=0.33;h=l<g?h+v:h-v;b.controls.left.x=b.x+q(h)*a;b.controls.left.y=b.y+f(h)*a;h-=n;b.controls.right.x=b.x+q(h)*d;b.controls.right.y=b.y+f(h)*d;return b},getReflection:function(a,b,d){var g=a.distanceTo(b);if(1E-4>=g)return d?new c.Vector:a.clone();b=A(a,b);return new c.Vector(g*Math.cos(b)+(d?0:a.x),g*Math.sin(b)+(d?0:a.y))},angleBetween:function(a,b){var c,g;if(4<=arguments.length)return c=
arguments[0]-arguments[2],g=arguments[1]-arguments[3],p(g,c);c=a.x-b.x;g=a.y-b.y;return p(g,c)},distanceBetweenSquared:function(a,b){var c=a.x-b.x,g=a.y-b.y;return c*c+g*g},distanceBetween:function(a,b){return d(x(a,b))},mod:function(a,b){for(;0>a;)a+=b;return a%b},Collection:function(){Array.call(this);1<arguments.length?Array.prototype.push.apply(this,arguments):arguments[0]&&Array.isArray(arguments[0])&&Array.prototype.push.apply(this,arguments[0])},Error:function(a){this.name="two.js";this.message=
a}}});c.Utils.Error.prototype=Error();c.Utils.Error.prototype.constructor=c.Utils.Error;c.Utils.Collection.prototype=[];c.Utils.Collection.constructor=c.Utils.Collection;_.extend(c.Utils.Collection.prototype,Backbone.Events,{pop:function(){var a=Array.prototype.pop.apply(this,arguments);this.trigger(c.Events.remove,[a]);return a},shift:function(){var a=Array.prototype.shift.apply(this,arguments);this.trigger(c.Events.remove,[a]);return a},push:function(){var a=Array.prototype.push.apply(this,arguments);
this.trigger(c.Events.insert,arguments);return a},unshift:function(){var a=Array.prototype.unshift.apply(this,arguments);this.trigger(c.Events.insert,arguments);return a},splice:function(){var a=Array.prototype.splice.apply(this,arguments),b;this.trigger(c.Events.remove,a);2<arguments.length&&(b=this.slice(arguments[0],arguments.length-2),this.trigger(c.Events.insert,b));return a}});var C=c.Utils.distanceBetween,x=c.Utils.distanceBetweenSquared,A=c.Utils.angleBetween,y=c.Utils.getControlPoints,z=
c.Utils.mod,E=c.Utils.getBackingStoreRatio,F=c.Utils.getPointOnCubicBezier;_.extend(c.prototype,Backbone.Events,{appendTo:function(a){a.appendChild(this.renderer.domElement);return this},play:function(){c.Utils.setPlaying.call(this,!0);return this.trigger(c.Events.play)},pause:function(){this.playing=!1;return this.trigger(c.Events.pause)},update:function(){var a=!!this._lastFrame,b=(m.performance&&m.performance.now?m.performance:Date).now();this.frameCount++;a&&(this.timeDelta=parseFloat((b-this._lastFrame).toFixed(3)));
this._lastFrame=b;var a=this.width,b=this.height,d=this.renderer;a===d.width&&b===d.height||d.setSize(a,b,this.ratio);this.trigger(c.Events.update,this.frameCount,this.timeDelta);return this.render()},render:function(){this.renderer.render();return this.trigger(c.Events.render,this.frameCount)},add:function(a){var b=a;_.isArray(a)||(b=_.toArray(arguments));this.scene.add(b);return this},remove:function(a){var b=a;_.isArray(a)||(b=_.toArray(arguments));this.scene.remove(b);return this},clear:function(){this.scene.remove(_.toArray(this.scene.children));
return this},makeLine:function(a,b,d,g){d=(d-a)/2;g=(g-b)/2;var l=[new c.Anchor(-d,-g),new c.Anchor(d,g)],l=(new c.Polygon(l)).noFill();l.translation.set(a+d,b+g);this.scene.add(l);return l},makeRectangle:function(a,b,d,g){d/=2;g/=2;g=[new c.Anchor(d,g),new c.Anchor(-d,g),new c.Anchor(-d,-g),new c.Anchor(d,-g)];g=new c.Polygon(g,!0);g.translation.set(a,b);this.scene.add(g);return g},makeCircle:function(a,b,c){return this.makeEllipse(a,b,c,c)},makeEllipse:function(a,b,d,g){var h=c.Resolution,n=_.map(_.range(h),
function(a){var b=a/h*l;a=d*q(b);b=g*f(b);return new c.Anchor(a,b)},this),n=new c.Polygon(n,!0,!0);n.translation.set(a,b);this.scene.add(n);return n},makeCurve:function(a){var b=arguments.length,d=a;if(!_.isArray(a))for(var d=[],g=0;g<b;g+=2){var l=arguments[g];if(!_.isNumber(l))break;d.push(new c.Anchor(l,arguments[g+1]))}var b=arguments[b-1],d=new c.Polygon(d,!(_.isBoolean(b)&&b),!0),b=d.getBoundingClientRect(),f=b.left+b.width/2,h=b.top+b.height/2;_.each(d.vertices,function(a){a.x-=f;a.y-=h});
d.translation.set(f,h);this.scene.add(d);return d},makePolygon:function(a){var b=arguments.length,d=a;if(!_.isArray(a))for(var d=[],g=0;g<b;g+=2){var l=arguments[g];if(!_.isNumber(l))break;d.push(new c.Anchor(l,arguments[g+1]))}b=arguments[b-1];d=new c.Polygon(d,!(_.isBoolean(b)&&b));b=d.getBoundingClientRect();d.center().translation.set(b.left+b.width/2,b.top+b.height/2);this.scene.add(d);return d},makeGroup:function(a){var b=a;_.isArray(a)||(b=_.toArray(arguments));var d=new c.Group;this.scene.add(d);
d.add(b);return d},interpret:function(a){var b=a.tagName.toLowerCase();if(!(b in c.Utils.read))return null;a=c.Utils.read[b].call(this,a);this.add(a);return a}});(function(){requestAnimationFrame(arguments.callee);_.each(c.Instances,function(a){a.playing&&a.update()})})();"function"===typeof define&&define.amd?define(function(){return c}):"undefined"!=typeof module&&module.exports&&(module.exports=c)})();(function(){var B,m,h,f,q=Two.Vector=function(d,f){this.x=d||0;this.y=f||0};_.extend(q.prototype,Backbone.Events,{set:function(d,f){this.x=d;this.y=f;return this},copy:function(d){this.x=d.x;this.y=d.y;return this},clear:function(){this.y=this.x=0;return this},clone:function(){return new q(this.x,this.y)},add:function(d,f){this.x=d.x+f.x;this.y=d.y+f.y;return this},addSelf:function(d){this.x+=d.x;this.y+=d.y;return this},sub:function(d,f){this.x=d.x-f.x;this.y=d.y-f.y;return this},subSelf:function(d){this.x-=
d.x;this.y-=d.y;return this},multiplySelf:function(d){this.x*=d.x;this.y*=d.y;return this},multiplyScalar:function(d){this.x*=d;this.y*=d;return this},divideScalar:function(d){d?(this.x/=d,this.y/=d):this.set(0,0);return this},negate:function(){return this.multiplyScalar(-1)},dot:function(d){return this.x*d.x+this.y*d.y},lengthSquared:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.lengthSquared())},normalize:function(){return this.divideScalar(this.length())},
distanceTo:function(d){return Math.sqrt(this.distanceToSquared(d))},distanceToSquared:function(d){h=this.x-d.x;f=this.y-d.y;return h*h+f*f},setLength:function(d){return this.normalize().multiplyScalar(d)},equals:function(d){return 1E-4>this.distanceTo(d)},lerp:function(d,f){B=(d.x-this.x)*f+this.x;m=(d.y-this.y)*f+this.y;return this.set(B,m)},isZero:function(){return 1E-4>this.length()},toString:function(){return this.x+","+this.y},toObject:function(){return{x:this.x,y:this.y}}});var p={set:function(d,
f){this._x=d;this._y=f;return this.trigger(Two.Events.change)},copy:function(d){this._x=d.x;this._y=d.y;return this.trigger(Two.Events.change)},clear:function(){this._y=this._x=0;return this.trigger(Two.Events.change)},clone:function(){return new q(this._x,this._y)},add:function(d,f){this._x=d.x+f.x;this._y=d.y+f.y;return this.trigger(Two.Events.change)},addSelf:function(d){this._x+=d.x;this._y+=d.y;return this.trigger(Two.Events.change)},sub:function(d,f){this._x=d.x-f.x;this._y=d.y-f.y;return this.trigger(Two.Events.change)},
subSelf:function(d){this._x-=d.x;this._y-=d.y;return this.trigger(Two.Events.change)},multiplySelf:function(d){this._x*=d.x;this._y*=d.y;return this.trigger(Two.Events.change)},multiplyScalar:function(d){this._x*=d;this._y*=d;return this.trigger(Two.Events.change)},divideScalar:function(d){return d?(this._x/=d,this._y/=d,this.trigger(Two.Events.change)):this.clear()},negate:function(){return this.multiplyScalar(-1)},dot:function(d){return this._x*d.x+this._y*d.y},lengthSquared:function(){return this._x*
this._x+this._y*this._y},length:function(){return Math.sqrt(this.lengthSquared())},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(d){return Math.sqrt(this.distanceToSquared(d))},distanceToSquared:function(d){h=this._x-d.x;f=this._y-d.y;return h*h+f*f},setLength:function(d){return this.normalize().multiplyScalar(d)},equals:function(d){return 1E-4>this.distanceTo(d)},lerp:function(d,f){B=(d.x-this._x)*f+this._x;m=(d.y-this._y)*f+this._y;return this.set(B,m)},isZero:function(){return 1E-4>
this.length()},toString:function(){return this._x+","+this._y},toObject:function(){return{x:this._x,y:this._y}}},d={get:function(){return this._x},set:function(d){this._x=d;this.trigger(Two.Events.change,"x")}},n={get:function(){return this._y},set:function(d){this._y=d;this.trigger(Two.Events.change,"y")}};Two.Vector.prototype.bind=Two.Vector.prototype.on=function(){this._bound||(this._x=this.x,this._y=this.y,Object.defineProperty(this,"x",d),Object.defineProperty(this,"y",n),_.extend(this,p),this._bound=
!0);Backbone.Events.bind.apply(this,arguments);return this}})();(function(){var B=Two.Commands,m,h,f,q=Two.Anchor=function(d,f,h,p,m,w,s){Two.Vector.call(this,d,f);this._broadcast=_.bind(function(){this.trigger(Two.Events.change)},this);Object.defineProperty(this,"command",{get:function(){return this._command},set:function(c){this._command=c;this._command!==B.curve||_.isObject(this.controls)||q.AppendCurveProperties(this);return this.trigger(Two.Events.change)}});this._command=s||B.move;if(!s)return this;q.AppendCurveProperties(this);_.isNumber(h)&&(this.controls.left.x=
h);_.isNumber(p)&&(this.controls.left.y=p);_.isNumber(m)&&(this.controls.right.x=m);_.isNumber(w)&&(this.controls.right.y=w)};_.extend(q,{AppendCurveProperties:function(d){m=d._x||d.x;h=d._y||d.y;d.controls={left:new Two.Vector(m,h),right:new Two.Vector(m,h)}}});var p={listen:function(){_.isObject(this.controls)||q.AppendCurveProperties(this);_.each(this.controls,function(d){d.bind(Two.Events.change,this._broadcast)},this);return this},ignore:function(){_.each(this.controls,function(d){d.unbind(Two.Events.change,
this._broadcast)},this);return this},clone:function(){f=this.controls;return new Two.Anchor(this.x,this.y,f&&f.left.x,f&&f.left.y,f&&f.right.x,f&&f.right.y,this.command)},toObject:function(){var d={x:this.x,y:this.y};this.command&&(d.command=this.command);this.controls&&(d.controls={left:this.controls.left.toObject(),right:this.controls.right.toObject()});return d}};_.extend(q.prototype,Two.Vector.prototype,p);Two.Anchor.prototype.bind=Two.Anchor.prototype.on=function(){Two.Vector.prototype.bind.apply(this,
arguments);_.extend(this,p)}})();(function(){_.range(6);var B=Math.cos,m=Math.sin,h=Math.tan,f,q,p,d,n,l,v,G,w,s,c,C,x,A,y,z,E,F,a,b,r,g,H,u,D,I,J,M,P,N,O,L,e,k,t,ea,S,T,$,ba,U,V,W,X,aa,ca,da,Y,Q,Z=[],fa=Two.Matrix=function(a,b,e,c,d,g){this.elements=new Two.Array(9);var f=a;_.isArray(f)||(f=_.toArray(arguments));this.identity().set(f)};_.extend(fa,{Identity:[1,0,0,0,1,0,0,0,1],Multiply:function(e,c,d){if(3>=c.length)return C,x,A,f=c[0]||0,q=c[1]||0,p=c[2]||0,n=e,C=n[0]*f+n[1]*q+n[2]*p,x=n[3]*f+n[4]*q+n[5]*p,A=n[6]*f+n[7]*q+n[8]*
p,{x:C,y:x,z:A};y=e[0];z=e[1];E=e[2];F=e[3];a=e[4];b=e[5];r=e[6];g=e[7];H=e[8];u=c[0];D=c[1];I=c[2];J=c[3];M=c[4];P=c[5];N=c[6];O=c[7];L=c[8];d=d||new Two.Array(9);d[0]=y*u+z*J+E*N;d[1]=y*D+z*M+E*O;d[2]=y*I+z*P+E*L;d[3]=F*u+a*J+b*N;d[4]=F*D+a*M+b*O;d[5]=F*I+a*P+b*L;d[6]=r*u+g*J+H*N;d[7]=r*D+g*M+H*O;d[8]=r*I+g*P+H*L;return d}});_.extend(fa.prototype,Backbone.Events,{set:function(a,b,e,d,g,f){c=a;t=arguments.length;_.isArray(c)||(c=_.toArray(arguments));_.each(c,function(a,b){_.isNumber(a)&&(this.elements[b]=
a)},this);return this.trigger(Two.Events.change)},identity:function(){this.set(fa.Identity);return this},multiply:function(d,f,h,l,n,q,p,m,ma){c=arguments;t=c.length;if(1>=t)return _.each(this.elements,function(a,b){this.elements[b]=a*d},this),this.trigger(Two.Events.change);if(3>=t)return C,x,A,d=d||0,f=f||0,h=h||0,n=this.elements,C=n[0]*d+n[1]*f+n[2]*h,x=n[3]*d+n[4]*f+n[5]*h,A=n[6]*d+n[7]*f+n[8]*h,{x:C,y:x,z:A};e=this.elements;k=c;y=e[0];z=e[1];E=e[2];F=e[3];a=e[4];b=e[5];r=e[6];g=e[7];H=e[8];u=
k[0];D=k[1];I=k[2];J=k[3];M=k[4];P=k[5];N=k[6];O=k[7];L=k[8];this.elements[0]=y*u+z*J+E*N;this.elements[1]=y*D+z*M+E*O;this.elements[2]=y*I+z*P+E*L;this.elements[3]=F*u+a*J+b*N;this.elements[4]=F*D+a*M+b*O;this.elements[5]=F*I+a*P+b*L;this.elements[6]=r*u+g*J+H*N;this.elements[7]=r*D+g*M+H*O;this.elements[8]=r*I+g*P+H*L;return this.trigger(Two.Events.change)},inverse:function(a){f=this.elements;a=a||new Two.Matrix;S=f[0];T=f[1];$=f[2];ba=f[3];U=f[4];V=f[5];W=f[6];X=f[7];aa=f[8];ca=aa*U-V*X;da=-aa*
ba+V*W;Y=X*ba-U*W;Q=S*ca+T*da+$*Y;if(!Q)return null;Q=1/Q;a.elements[0]=ca*Q;a.elements[1]=(-aa*T+$*X)*Q;a.elements[2]=(V*T-$*U)*Q;a.elements[3]=da*Q;a.elements[4]=(aa*S-$*W)*Q;a.elements[5]=(-V*S+$*ba)*Q;a.elements[6]=Y*Q;a.elements[7]=(-X*S+T*W)*Q;a.elements[8]=(U*S-T*ba)*Q;return a},scale:function(a,b){t=arguments.length;1>=t&&(b=a);return this.multiply(a,0,0,0,b,0,0,0,1)},rotate:function(a){p=B(a);ea=m(a);return this.multiply(p,-ea,0,ea,p,0,0,0,1)},translate:function(a,b){return this.multiply(1,
0,a,0,1,b,0,0,1)},skewX:function(a){f=h(a);return this.multiply(1,f,0,0,1,0,0,0,1)},skewY:function(a){f=h(a);return this.multiply(1,0,0,f,1,0,0,0,1)},toString:function(a){this.toArray(a,Z);return Z.join(" ")},toArray:function(a,b){c=this.elements;s=!!b;f=parseFloat(c[0].toFixed(3));q=parseFloat(c[1].toFixed(3));p=parseFloat(c[2].toFixed(3));d=parseFloat(c[3].toFixed(3));n=parseFloat(c[4].toFixed(3));l=parseFloat(c[5].toFixed(3));if(a){v=parseFloat(c[6].toFixed(3));G=parseFloat(c[7].toFixed(3));w=
parseFloat(c[8].toFixed(3));if(s){b[0]=f;b[1]=d;b[2]=v;b[3]=q;b[4]=n;b[5]=G;b[6]=p;b[7]=l;b[8]=w;return}return[f,d,v,q,n,G,p,l,w]}if(s)b[0]=f,b[1]=d,b[2]=q,b[3]=n,b[4]=p,b[5]=l;else return[f,d,q,n,p,l]},clone:function(){f=this.elements[0];q=this.elements[1];p=this.elements[2];d=this.elements[3];n=this.elements[4];l=this.elements[5];v=this.elements[6];G=this.elements[7];w=this.elements[8];return new Two.Matrix(f,q,p,d,n,l,v,G,w)}})})();(function(){var B=Two.Utils.mod,m,h,f,q={version:1.1,ns:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",createElement:function(d,n){f=d;h=document.createElementNS(this.ns,f);"svg"===f&&(n=_.defaults(n||{},{version:this.version}));_.isObject(n)&&q.setAttributes(h,n);return h},setAttribute:function(d,f){this.setAttribute(f,d)},setAttributes:function(d,f){_.each(f,q.setAttribute,d);return this},removeAttribute:function(d,f){this.removeAttribute(f)},removeAttributes:function(d,f){_.each(f,
q.removeAttribute,d);return this},toString:function(d,f){var h=d.length,q=h-1;return _.map(d,function(p,m){var s,c=f?B(m-1,h):Math.max(m-1,0),C=f?B(m+1,h):Math.min(m+1,q),c=d[c],C=d[C],x,A,y,z,E;E=p.x.toFixed(3);z=p.y.toFixed(3);switch(p._command){case Two.Commands.close:s=Two.Commands.close;break;case Two.Commands.curve:x=c.controls&&c.controls.right||c;s=p.controls&&p.controls.left||p;c=x.x.toFixed(3);x=x.y.toFixed(3);A=s.x.toFixed(3);y=s.y.toFixed(3);s=(0===m?Two.Commands.move:Two.Commands.curve)+
" "+c+" "+x+" "+A+" "+y+" "+E+" "+z;break;default:s=(0===m?Two.Commands.move:p._command)+" "+E+" "+z}m>=q&&f&&(p._command===Two.Commands.curve&&(z=p.controls&&p.controls.right||p,E=C.controls&&C.controls.left||C,c=z.x.toFixed(3),x=z.y.toFixed(3),A=E.x.toFixed(3),y=E.y.toFixed(3),E=C.x.toFixed(3),z=C.y.toFixed(3),s+=" C "+c+" "+x+" "+A+" "+y+" "+E+" "+z),s+=" Z");return s}).join(" ")},group:{appendChild:function(d){(h=this.domElement.querySelector("#"+Two.Identifier+d))&&this.elem.appendChild(h)},
removeChild:function(d){(h=this.domElement.querySelector("#"+Two.Identifier+d))&&this.elem.removeChild(h)},renderChild:function(d){q[d._renderer.type].render.call(d,this)},render:function(d){this._update();this._renderer.elem||(this._renderer.elem=q.createElement("g",{id:Two.Identifier+this.id}),d.appendChild(this._renderer.elem));m=this._matrix.manual||this._flagMatrix;var f={domElement:d,elem:this._renderer.elem};m&&this._renderer.elem.setAttribute("transform","matrix("+this._matrix.toString()+
")");_.each(this.children,q.group.renderChild,d);this._flagAdditions&&_.each(this.additions,q.group.appendChild,f);this._flagSubtractions&&_.each(this.subtractions,q.group.removeChild,f);return this.flagReset()}},polygon:{render:function(d){this._update();this._renderer.elem||(this._renderer.elem=q.createElement("path",{id:Two.Identifier+this.id}),d.appendChild(this._renderer.elem));h=this._renderer.elem;(m=this._matrix.manual||this._flagMatrix)&&h.setAttribute("transform","matrix("+this._matrix.toString()+
")");this._flagVertices&&(vertices=q.toString(this._vertices,this._closed),h.setAttribute("d",vertices));this._flagFill&&h.setAttribute("fill",this._fill);this._flagStroke&&h.setAttribute("stroke",this._stroke);this._flagLinewidth&&h.setAttribute("stroke-width",this._linewidth);this._flagOpacity&&(h.setAttribute("stroke-opacity",this._opacity),h.setAttribute("fill-opacity",this._opacity));this._flagVisible&&h.setAttribute("visibility",this._visible?"visible":"hidden");this._flagCap&&h.setAttribute("stroke-linecap",
this._cap);this._flagJoin&&h.setAttribute("stroke-linejoin",this._join);this._flagMiter&&h.setAttribute("stroke-miterlimit",this.miter);return this.flagReset()}}},p=Two[Two.Types.svg]=function(d){this.domElement=d.domElement||q.createElement("svg");this.scene=new Two.Group;this.scene.parent=this};_.extend(p,{Utils:q});_.extend(p.prototype,Backbone.Events,{setSize:function(d,f){this.width=d;this.height=f;q.setAttributes(this.domElement,{width:d,height:f});return this},render:function(){q.group.render.call(this.scene,
this.domElement);return this}})})();(function(){var B=Two.Utils.mod,m=Two.Utils.getRatio,h,f,q,p,d,n,l,v,G,w,s,c,C,x,A,y,z,E,F,a,b,r,g,H,u,D,I,J={group:{renderChild:function(a){J[a._renderer.type].render.call(a,this)},render:function(a){this._update();h=this._matrix.elements;a.save();a.transform(h[0],h[3],h[1],h[4],h[2],h[5]);_.each(this.children,J.group.renderChild,a);a.restore();return this.flagReset()}},polygon:{render:function(m){this._update();h=this._matrix.elements;f=this.stroke;q=this.linewidth;p=this.fill;d=this.opacity;n=
this.visible;l=this.cap;v=this.join;G=this.miter;w=this.closed;s=this._vertices;c=s.length;C=c-1;if(!n)return this;m.save();h&&m.transform(h[0],h[3],h[1],h[4],h[2],h[5]);p&&(m.fillStyle=p);f&&(m.strokeStyle=f);q&&(m.lineWidth=q);G&&(m.miterLimit=G);v&&(m.lineJoin=v);l&&(m.lineCap=l);_.isNumber(d)&&(m.globalAlpha=d);m.beginPath();_.each(s,function(d,f){D=d.x.toFixed(3);I=d.y.toFixed(3);switch(d._command){case Two.Commands.close:m.closePath();break;case Two.Commands.curve:A=w?B(f-1,c):Math.max(f-1,
0);x=w?B(f+1,c):Math.min(f+1,C);y=s[A];z=s[x];r=y.controls&&y.controls.right||y;g=d.controls&&d.controls.left||d;a=r.x.toFixed(3);b=r.y.toFixed(3);E=g.x.toFixed(3);F=g.y.toFixed(3);m.bezierCurveTo(a,b,E,F,D,I);f>=C&&w&&(H=d.controls&&d.controls.right||d,u=z.controls&&z.controls.left||z,a=H.x.toFixed(3),b=H.y.toFixed(3),E=u.x.toFixed(3),F=u.y.toFixed(3),D=z.x.toFixed(3),I=z.y.toFixed(3),m.bezierCurveTo(a,b,E,F,D,I));break;case Two.Commands.line:m.lineTo(D,I);break;case Two.Commands.move:m.moveTo(D,
I)}});w&&m.closePath();m.fill();m.stroke();m.restore();return this.flagReset()}}},M=Two[Two.Types.canvas]=function(a){this.domElement=a.domElement||document.createElement("canvas");this.ctx=this.domElement.getContext("2d");this.overdraw=!1;this.scene=new Two.Group;this.scene.parent=this};_.extend(M,{Utils:J});_.extend(M.prototype,Backbone.Events,{setSize:function(a,b,c){this.width=a;this.height=b;this.ratio=_.isUndefined(c)?m(this.ctx):c;this.domElement.width=a*this.ratio;this.domElement.height=b*
this.ratio;_.extend(this.domElement.style,{width:a+"px",height:b+"px"});return this},render:function(){var a=1===this.ratio;a||(this.ctx.save(),this.ctx.scale(this.ratio,this.ratio));this.overdraw||this.ctx.clearRect(0,0,this.width,this.height);J.group.render.call(this.scene,this.ctx);a||this.ctx.restore();return this}})})();(function(){var B=Two.Matrix.Multiply,m=Two.Utils.mod,h=[1,0,0,0,1,0,0,0,1],f=new Two.Array(9),q=Two.Utils.getRatio,p,d,n,l,v,G,w,s,c,C,x,A,y,z,E,F,a,b,r,g,H,u,D,I,J,M,P,N,O,L,e,k,t,ea,S,T,$,ba,U,V,W,X,aa,ca,da,Y,Q,Z,fa,ga,K,ia,ja,ka,ha,R={canvas:document.createElement("canvas"),uv:new Two.Array([0,0,1,0,0,1,0,1,1,0,1,1]),group:{renderChild:function(a){R[a._renderer.type].render.call(a,this.gl,this.program)},render:function(a,b){this._update();p=this.parent;d=p._matrix&&p._matrix.manual||p._flagMatrix;
n=this._matrix.manual||this._flagMatrix;if(d||n)this._renderer.matrix||(this._renderer.matrix=new Two.Array(9)),this._matrix.toArray(!0,f),B(f,p._renderer.matrix,this._renderer.matrix),this._renderer.scale=this._scale*p._renderer.scale,d&&(this._flagMatrix=!0);_.each(this.children,R.group.renderChild,{gl:a,program:b});return this.flagReset()}},polygon:{render:function(a,b){if(!this._visible||!this._opacity)return this;p=this.parent;d=p._matrix.manual||p._flagMatrix;n=this._matrix.manual||this._flagMatrix;
l=this._flagVertices||this._flagFill||this._flagStroke||this._flagLinewidth||this._flagOpacity||this._flagVisible||this._flagCap||this._flagJoin||this._flagMiter||this._flagScale;this._update();if(d||n)this._renderer.matrix||(this._renderer.matrix=new Two.Array(9)),this._matrix.toArray(!0,f),B(f,p._renderer.matrix,this._renderer.matrix),this._renderer.scale=this._scale*p._renderer.scale;l&&(this._renderer.rect||(this._renderer.rect={}),this._renderer.triangles||(this._renderer.triangles=new Two.Array(12)),
R.getBoundingClientRect(this._vertices,this._linewidth,this._renderer.rect),R.getTriangles(this._renderer.rect,this._renderer.triangles),R.updateBuffer(a,this,b),R.updateTexture(a,this));a.bindBuffer(a.ARRAY_BUFFER,this._renderer.textureCoordsBuffer);a.vertexAttribPointer(b.textureCoords,2,a.FLOAT,!1,0,0);a.bindTexture(a.TEXTURE_2D,this._renderer.texture);a.uniformMatrix3fv(b.matrix,!1,this._renderer.matrix);a.bindBuffer(a.ARRAY_BUFFER,this._renderer.buffer);a.vertexAttribPointer(b.position,2,a.FLOAT,
!1,0,0);a.drawArrays(a.TRIANGLES,0,6);return this.flagReset()}},getBoundingClientRect:function(e,d,g){v=Infinity;G=-Infinity;w=Infinity;s=-Infinity;_.each(e,function(b,e){c=b.x;C=b.y;x;A;y;z;E=b.controls;w=Math.min(C,w);v=Math.min(c,v);G=Math.max(c,G);s=Math.max(C,s);b.controls&&(F=E.left,a=E.right,F&&a&&(x=F.x,A=F.y,y=a.x,z=a.y,x&&(A&&y&&z)&&(w=Math.min(A,z,w),v=Math.min(x,y,v),G=Math.max(x,y,G),s=Math.max(A,z,s))))});_.isNumber(d)&&(w-=d,v-=d,G+=d,s+=d);b=G-v;r=s-w;g.top=w;g.left=v;g.right=G;g.bottom=
s;g.width=b;g.height=r;g.centroid||(g.centroid={});g.centroid.x=-v;g.centroid.y=-w},getTriangles:function(a,b){w=a.top;v=a.left;G=a.right;s=a.bottom;b[0]=v;b[1]=w;b[2]=G;b[3]=w;b[4]=v;b[5]=s;b[6]=v;b[7]=s;b[8]=G;b[9]=w;b[10]=G;b[11]=s},updateCanvas:function(a){g=a._vertices;H=this.canvas;u=this.ctx;D=a._renderer.scale;I=a._stroke;J=a._linewidth*D;M=a._fill;P=a._opacity;N=a._cap;O=a._join;L=a._miter;e=a._closed;k=g.length;t=k-1;H.width=Math.max(Math.ceil(a._renderer.rect.width*D),1);H.height=Math.max(Math.ceil(a._renderer.rect.height*
D),1);ea=a._renderer.rect.centroid;S=ea.x*D;T=ea.y*D;u.clearRect(0,0,H.width,H.height);M&&(u.fillStyle=M);I&&(u.strokeStyle=I);J&&(u.lineWidth=J);L&&(u.miterLimit=L);O&&(u.lineJoin=O);N&&(u.lineCap=N);_.isNumber(P)&&(u.globalAlpha=P);u.beginPath();_.each(g,function(a,b){$;ba;x;y;U;V;W;X;aa;ca;da;F;c=(a.x*D+S).toFixed(3);C=(a.y*D+T).toFixed(3);switch(a._command){case Two.Commands.close:u.closePath();break;case Two.Commands.curve:ba=e?m(b-1,k):Math.max(b-1,0);$=e?m(b+1,k):Math.min(b+1,t);x=g[ba];y=
g[$];aa=x.controls&&x.controls.right||x;ca=a.controls&&a.controls.left||a;W=(aa.x*D+S).toFixed(3);X=(aa.y*D+T).toFixed(3);U=(ca.x*D+S).toFixed(3);V=(ca.y*D+T).toFixed(3);u.bezierCurveTo(W,X,U,V,c,C);b>=t&&e&&(da=a.controls&&a.controls.right||a,F=y.controls&&y.controls.left||y,W=(da.x*D+S).toFixed(3),X=(da.y*D+T).toFixed(3),U=(F.x*D+S).toFixed(3),V=(F.y*D+T).toFixed(3),c=(y.x*D+S).toFixed(3),C=(y.y*D+T).toFixed(3),u.bezierCurveTo(W,X,U,V,c,C));break;case Two.Commands.line:u.lineTo(c,C);break;case Two.Commands.move:u.moveTo(c,
C)}});e&&u.closePath();u.fill();u.stroke()},updateTexture:function(a,b){this.updateCanvas(b);b._renderer.texture&&a.deleteTexture(b._renderer.texture);a.bindBuffer(a.ARRAY_BUFFER,b._renderer.textureCoordsBuffer);b._renderer.texture=a.createTexture();a.bindTexture(a.TEXTURE_2D,b._renderer.texture);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR);0>=this.canvas.width||
0>=this.canvas.height||a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,this.canvas)},updateBuffer:function(a,b,e){_.isObject(b._renderer.buffer)&&a.deleteBuffer(b._renderer.buffer);b._renderer.buffer=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,b._renderer.buffer);a.enableVertexAttribArray(e.position);a.bufferData(a.ARRAY_BUFFER,b._renderer.triangles,a.STATIC_DRAW);_.isObject(b._renderer.textureCoordsBuffer)&&a.deleteBuffer(b._renderer.textureCoordsBuffer);b._renderer.textureCoordsBuffer=
a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,b._renderer.textureCoordsBuffer);a.enableVertexAttribArray(e.textureCoords);a.bufferData(a.ARRAY_BUFFER,this.uv,a.STATIC_DRAW)},program:{create:function(a,b){Y=a.createProgram();_.each(b,function(b){a.attachShader(Y,b)});a.linkProgram(Y);Q=a.getProgramParameter(Y,a.LINK_STATUS);if(!Q)throw ga=a.getProgramInfoLog(Y),a.deleteProgram(Y),new Two.Utils.Error("unable to link program: "+ga);return Y}},shaders:{create:function(a,b,e){Z=a.createShader(a[e]);a.shaderSource(Z,
b);a.compileShader(Z);fa=a.getShaderParameter(Z,a.COMPILE_STATUS);if(!fa)throw ga=a.getShaderInfoLog(Z),a.deleteShader(Z),new Two.Utils.Error("unable to compile shader "+Z+": "+ga);return Z},types:{vertex:"VERTEX_SHADER",fragment:"FRAGMENT_SHADER"},vertex:"attribute vec2 a_position;\nattribute vec2 a_textureCoords;\n\nuniform mat3 u_matrix;\nuniform vec2 u_resolution;\n\nvarying vec2 v_textureCoords;\n\nvoid main() {\n   vec2 projected = (u_matrix * vec3(a_position, 1.0)).xy;\n   vec2 normal = projected / u_resolution;\n   vec2 clipspace = (normal * 2.0) - 1.0;\n\n   gl_Position = vec4(clipspace * vec2(1.0, -1.0), 0.0, 1.0);\n   v_textureCoords = a_textureCoords;\n}",
fragment:"precision mediump float;\n\nuniform sampler2D u_image;\nvarying vec2 v_textureCoords;\n\nvoid main() {\n  gl_FragColor = texture2D(u_image, v_textureCoords);\n}"}};R.ctx=R.canvas.getContext("2d");var la=Two[Two.Types.webgl]=function(a){this.domElement=a.domElement||document.createElement("canvas");this.scene=new Two.Group;this.scene.parent=this;this._renderer={matrix:new Two.Array(h),scale:1};this._flagMatrix=!0;ha=_.defaults(a||{},{antialias:!1,alpha:!0,premultipliedAlpha:!0,stencil:!0,
preserveDrawingBuffer:!0,overdraw:!1});this.overdraw=ha.overdraw;K=this.ctx=this.domElement.getContext("webgl",ha)||this.domElement.getContext("experimental-webgl",ha);if(!this.ctx)throw new Two.Utils.Error("unable to create a webgl context. Try using another renderer.");ka=R.shaders.create(K,R.shaders.vertex,R.shaders.types.vertex);ja=R.shaders.create(K,R.shaders.fragment,R.shaders.types.fragment);this.program=R.program.create(K,[ka,ja]);K.useProgram(this.program);this.program.position=K.getAttribLocation(this.program,
"a_position");this.program.matrix=K.getUniformLocation(this.program,"u_matrix");this.program.textureCoords=K.getAttribLocation(this.program,"a_textureCoords");K.disable(K.DEPTH_TEST);K.enable(K.BLEND);K.blendEquationSeparate(K.FUNC_ADD,K.FUNC_ADD);K.blendFuncSeparate(K.SRC_ALPHA,K.ONE_MINUS_SRC_ALPHA,K.ONE,K.ONE_MINUS_SRC_ALPHA)};_.extend(la.prototype,Backbone.Events,{setSize:function(a,b,e){this.width=a;this.height=b;this.ratio=_.isUndefined(e)?q(this.ctx):e;this.domElement.width=a*this.ratio;this.domElement.height=
b*this.ratio;_.extend(this.domElement.style,{width:a+"px",height:b+"px"});a*=this.ratio;b*=this.ratio;this._renderer.matrix[0]=this._renderer.matrix[4]=this._renderer.scale=this.ratio;this._flagMatrix=!0;this.ctx.viewport(0,0,a,b);ia=this.ctx.getUniformLocation(this.program,"u_resolution");this.ctx.uniform2f(ia,a,b);return this},render:function(){K=this.ctx;this.overdraw||K.clear(K.COLOR_BUFFER_BIT|K.DEPTH_BUFFER_BIT);R.group.render.call(this.scene,K,this.program);this._flagMatrix=!1;return this}})})();(function(){new Two.Vector;var B,m=Two.Shape=function(h){this._renderer={};this.id=Two.uniqueId();this._matrix=new Two.Matrix;this.translation=new Two.Vector;this.translation.bind(Two.Events.change,_.bind(m.FlagMatrix,this));this.rotation=0;this.scale=1};_.extend(m,Backbone.Events,{FlagMatrix:function(){this._flagMatrix=!0},MakeObservable:function(h){Object.defineProperty(h,"rotation",{get:function(){return this._rotation},set:function(f){this._rotation=f;this._flagMatrix=!0}});Object.defineProperty(h,
"scale",{get:function(){return this._scale},set:function(f){this._scale=f;this._flagScale=this._flagMatrix=!0}})}});_.extend(m.prototype,{_flagMatrix:!0,_rotation:0,_scale:1,addTo:function(h){h.add(this);return this},clone:function(){B=new m;B.translation.copy(this.translation);B.rotation=this.rotation;B.scale=this.scale;_.each(m.Properties,function(h){B[h]=this[h]},this);return B._update()},_update:function(){!this._matrix.manual&&this._flagMatrix&&this._matrix.identity().translate(this.translation.x,
this.translation.y).scale(this.scale).rotate(this.rotation);return this},flagReset:function(){this._flagScale=this._flagMatrix=!1;return this}});m.MakeObservable(m.prototype)})();(function(){var B=Math.min,m=Math.max,h=Math.round,f=Two.Utils.getComputedMatrix,q,p,d,n,l,v,G,w,s,c,C,x,A,y,z,E,F,a,b,r,g,H,u,D,I,J,M,P,N,O,L=Two.Polygon=function(a,b,c,d){Two.Shape.call(this);this._renderer.type="polygon";this._closed=!!b;this._curved=!!c;this.beginning=0;this.ending=1;this.fill="#fff";this.stroke="#000";this.opacity=this.linewidth=1;this.visible=!0;this.cap="butt";this.join="miter";this.miter=4;this._vertices=[];this.vertices=a;this.automatic=!d};_.extend(L,{Properties:"fill stroke linewidth opacity visible cap join miter closed curved automatic beginning ending".split(" "),
FlagVertices:function(){this._flagVertices=!0},MakeObservable:function(a){Two.Shape.MakeObservable(a);_.each(L.Properties.slice(0,8),function(b){var c="_"+b,d="_flag"+b.charAt(0).toUpperCase()+b.slice(1);Object.defineProperty(a,b,{get:function(){return this[c]},set:function(a){this[c]=a;this[d]=!0}})});Object.defineProperty(a,"closed",{get:function(){return this._closed},set:function(a){this._closed=!!a;this._flagVertices=!0}});Object.defineProperty(a,"curved",{get:function(){return this._curved},
set:function(a){this._curved=!!a;this._flagVertices=!0}});Object.defineProperty(L.prototype,"automatic",{get:function(){return this._automatic},set:function(a){a!==this._automatic&&(method=(this._automatic=!!a)?"ignore":"listen",_.each(this.vertices,function(a){a[method]()}))}});Object.defineProperty(a,"beginning",{get:function(){return this._beginning},set:function(a){this._beginning=B(m(a,0),1);this._flagVertices=!0}});Object.defineProperty(a,"ending",{get:function(){return this._ending},set:function(a){this._ending=
B(m(a,0),1);this._flagVertices=!0}});Object.defineProperty(a,"vertices",{get:function(){return this._collection},set:function(a){var b=_.bind(L.FlagVertices,this),c=_.bind(function(a){_.each(a,function(a){a.bind(Two.Events.change,b)},this);b()},this),e=_.bind(function(a){_.each(a,function(a){a.unbind(Two.Events.change,b)},this);b()},this);this._collection&&this._collection.unbind();this._collection=new Two.Utils.Collection(a.slice(0));this._collection.bind(Two.Events.insert,c);this._collection.bind(Two.Events.remove,
e);verticesChanged=!0;c(this._collection)}})}});_.extend(L.prototype,Two.Shape.prototype,{_flagVertices:!0,_flagFill:!0,_flagStroke:!0,_flagLinewidth:!0,_flagOpacity:!0,_flagVisible:!0,_flagCap:!0,_flagJoin:!0,_flagMiter:!0,_fill:"#fff",_stroke:"#000",_linewidth:1,_opacity:1,_visible:!0,_cap:"round",_join:"round",_miter:4,_closed:!0,_curved:!1,_automatic:!0,_beginning:0,_ending:1,clone:function(a){a=a||this.parent;w=_.map(this.vertices,function(a){return a.clone()});s=new L(w,this.closed,this.curved,
!this.automatic);_.each(Two.Shape.Properties,function(a){s[a]=this[a]},this);s.translation.copy(this.translation);s.rotation=this.rotation;s.scale=this.scale;a.add(s);return s},toObject:function(){var a={vertices:_.map(this.vertices,function(a){return a.toObject()})};_.each(Two.Shape.Properties,function(b){a[b]=this[b]},this);a.translation=this.translation.toObject;a.rotation=this.rotation;a.scale=this.scale;return a},noFill:function(){this.fill="transparent";return this},noStroke:function(){this.stroke=
"transparent";return this},corner:function(){c=this.getBoundingClientRect(!0);c.centroid={x:c.left+c.width/2,y:c.top+c.height/2};_.each(this.vertices,function(a){a.addSelf(c.centroid)});return this},center:function(){c=this.getBoundingClientRect(!0);c.centroid={x:c.left+c.width/2,y:c.top+c.height/2};_.each(this.vertices,function(a){a.subSelf(c.centroid)});return this},remove:function(){if(!this.parent)return this;this.parent.remove(this);return this},getBoundingClientRect:function(c){this._update();
C=this.linewidth/2;void 0;x=Infinity;A=-Infinity;y=Infinity;z=-Infinity;_.each(this._vertices,function(a){E=a.x;F=a.y;y=B(F,y);x=B(E,x);A=m(E,A);z=m(F,z)});y-=C;x-=C;A+=C;z+=C;H=c?this._matrix:f(this);a=H.multiply(x,y,1);b=H.multiply(A,y,1);r=H.multiply(A,z,1);g=H.multiply(x,z,1);y=B(a.y,b.y,r.y,g.y);x=B(a.x,b.x,r.x,g.x);A=m(a.x,b.x,r.x,g.x);z=m(a.y,b.y,r.y,g.y);return{top:y,left:x,right:A,bottom:z,width:A-x,height:z-y}},plot:function(){if(this.curved)return Two.Utils.getCurveFromPoints(this.vertices,
this.closed),this;_.each(this.vertices,function(a,b){a._command=0===b?Two.Commands.move:Two.Commands.line},this);return this},subdivide:function(a){this._update();n=this.vertices.length-1;b=this.vertices[n];l=this._closed||this.vertices[n].command===Two.Commands.close;w=[];_.each(this.vertices,function(c,d){if(0>=d&&!l||c.command===Two.Commands.move)w.push(new Two.Anchor(b.x,b.y)),w[w.length-1].command=Two.Commands.line;else{A=b.controls&&b.controls.right;x=c.controls&&c.controls.left;u=b.x;D=b.y;
I=(A||b).x;J=(A||b).y;M=(x||c).x;P=(x||c).y;N=c.x;O=c.y;var g=Two.Utils.subdivide(u,D,I,J,M,P,N,O,a);w=w.concat(g);_.each(g,function(a,c){a.command=0>=c&&b.command===Two.Commands.move?Two.Commands.move:Two.Commands.line});d>=n&&(w.push(new Two.Anchor(N,O)),w[w.length-1].command=l?Two.Commands.close:Two.Commands.line)}b=c},this);this._curved=this._automatic=!1;this.vertices=w;return this},_update:function(){if(this._flagVertices)for(this._automatic&&this.plot(),q=this.vertices.length,n=q-1,p=h(this._beginning*
n),d=h(this._ending*n),this._vertices.length=0,G=p;G<d+1;G++)v=this.vertices[G],this._vertices.push(v);Two.Shape.prototype._update.call(this);return this},flagReset:function(){this._flagVertices=this._flagFill=this._flagStroke=this._flagLinewidth=this._flagOpacity=this._flagVisible=this._flagCap=this._flagJoin=this._flagMiter=!1;Two.Shape.prototype.flagReset.call(this);return this}});L.MakeObservable(L.prototype)})();(function(){var B=Math.min,m=Math.max,h,f,q,p,d,n,l,v,G,w,s,c,C,x,A,y,z,E,F,a,b,r=Two.Group=function(a){Two.Shape.call(this,!0);this._renderer.type="group";this.additions=[];this.subtractions=[];this.children={}};_.extend(r,{MakeObservable:function(a){Two.Shape.MakeObservable(a);r.MakeGetterSetter(a,Two.Polygon.Properties)},MakeGetterSetter:function(a,b){_.isArray(b)||(b=[b]);_.each(b,function(b){h="_"+b;Object.defineProperty(a,b,{get:function(){return this[h]},set:function(a){this[h]=a;_.each(this.children,
function(c){c[b]=a})}})})}});_.extend(r.prototype,Two.Shape.prototype,{_flagAdditions:!1,_flagSubtractions:!1,_fill:"#fff",_stroke:"#000",_linewidth:1,_opacity:1,_visible:!0,_cap:"round",_join:"round",_miter:4,_closed:!0,_curved:!1,_automatic:!0,_beginning:0,_ending:1,clone:function(a){a=a||this.parent;q=_.map(this.children,function(a){return a.clone()});p=new r;a.add(p);p.add(q);p.translation.copy(this.translation);p.rotation=this.rotation;p.scale=this.scale;return p},toObject:function(){var a={children:{},
translation:this.translation.toObject(),rotation:this.rotation,scale:this.scale};_.each(this.children,function(b,c){a.children[c]=b.toObject()},this);return a},corner:function(){d=this.getBoundingClientRect(!0);n={x:d.left,y:d.top};_.each(this.children,function(a){a.translation.subSelf(n)});return this},center:function(){d=this.getBoundingClientRect(!0);d.centroid={x:d.left+d.width/2,y:d.top+d.height/2};_.each(this.children,function(a){a.translation.subSelf(d.centroid)});return this},add:function(a){l=
arguments.length;v=a;q=this.children;G=this.parent;w=this.additions;_.isArray(a)||(v=_.toArray(arguments));_.each(v,function(a){a&&(s=a.id,f=a.parent,_.isUndefined(q[s])&&(f&&(delete f.children[s],b=_.indexOf(f.additions,s),0<=b&&f.additions.splice(b,1)),q[s]=a,a.parent=this,w.push(s),this._flagAdditions=!0))},this);return this},remove:function(a){l=arguments.length;v=a;q=this.children;G=this.parent;w=this.subtractions;if(0>=l&&G)return G.remove(this),this;_.isArray(a)||(v=_.toArray(arguments));_.each(v,
function(a){s=a.id;grandchildren=a.children;f=a.parent;s in q&&(delete q[s],delete a.parent,b=_.indexOf(f.additions,s),0<=b&&f.additions.splice(b,1),w.push(s),this._flagSubtractions=!0)},this);return this},getBoundingClientRect:function(b){this._update();c=Infinity;C=-Infinity;x=Infinity;A=-Infinity;_.each(this.children,function(a){d=a.getBoundingClientRect(!0);_.isNumber(d.top)&&(_.isNumber(d.left)&&_.isNumber(d.right)&&_.isNumber(d.bottom))&&(x=B(d.top,x),c=B(d.left,c),C=m(d.right,C),A=m(d.bottom,
A))},this);y=b?this._matrix:Two.Utils.getComputedMatrix(this);z=y.multiply(c,x,1);E=y.multiply(C,x,1);F=y.multiply(C,A,1);a=y.multiply(c,A,1);x=B(z.y,E.y,F.y,a.y);c=B(z.x,E.x,F.x,a.x);C=m(z.x,E.x,F.x,a.x);A=m(z.y,E.y,F.y,a.y);return{top:x,left:c,right:C,bottom:A,width:C-c,height:A-x}},noFill:function(){_.each(this.children,function(a){a.noFill()});return this},noStroke:function(){_.each(this.children,function(a){a.noStroke()});return this},subdivide:function(){var a=arguments;_.each(this.children,
function(b){b.subdivide.apply(b,a)});return this},flagReset:function(){this._flagAdditions&&(this.additions.length=0,this._flagAdditions=!1);this._flagSubtractions&&(this.subtractions.length=0,this._flagSubtractions=!1);Two.Shape.prototype.flagReset.call(this);return this}});r.MakeObservable(r.prototype)})();
